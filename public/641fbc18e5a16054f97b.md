---
title: Discord.js v14 botの作り方【基礎・メッセージ編】 (2024/5/22現在)
tags:
  - JavaScript
  - Node.js
  - discord
  - discord.js
private: false
updated_at: '2024-10-04T20:21:02+09:00'
id: 641fbc18e5a16054f97b
organization_url_name: null
slide: false
ignorePublish: false
---
# Discord.js とは
Discord.js (以下d.js) とは、discordのbotを開発するときに使用するパッケージの1つです。
同様に、Discord.pyというものがあります。これはpythonで開発する場合のパッケージになります。
詳しくは[こちら](https://qiita.com/minoru_kinugasa/items/e1bdee4ca016b2a38e2c)をごらんください！

# 今回の目標
メッセージの仕組みと、複数の送信方法を理解する。
いろんな種類があるので、できるだけわかりやすく簡単に説明します！

# メッセージについて
送信方法は大きく分けて3つあります。
1. チャンネルを探して、送信する
1. メッセージに対して、返信する
1. ユーザーを探して、ダイレクトメッセージ (DM) を送信する

それぞれ方法を簡単に説明します！

## チャンネルを探して、送信する
### チャンネルを探す とは
まず`探す`ってどういうことでしょうか？
Botは、複数のサーバーに導入されます。
また、チャンネルにはそれぞれ唯一無二のidが紐づけられています。

大量のサーバーの、大量のチャンネルの中から1つのチャンネルを探し出さなくては、どこに送信したらいいかわからないのです。
そのため、探してから送信しなければいけません。

### idの取得方法
チャンネルid以外にも、discordのありとあらゆるものにidがあります。
- ユーザーid
- サーバーid
- チャンネルid (カテゴリーid)
- ロールid
- メッセージid
- スレッドid
この様々なidを取得する方法は、以下のとおりです。

|手順|説明|備考|
|---|---|---|
|1|discordのユーザー設定に移動します。|![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3794632/46263b9a-872f-4391-483c-76d55e7629d8.png)|
|2|左のメニューの下の方にある、「**詳細設定**」に移動します。|![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3794632/696b3902-9648-6ef8-ffa2-19d53c65b0bd.png)|
|3|「**開発者モード**」を`on`にします。|![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3794632/ac670931-2a09-575c-10b6-cd8552c42146.png)|
|4|右クリック (スマホの場合は長押し) でidをコピーすることができるようになります。|![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3794632/dece970c-aaa1-aa8f-9ec4-a82818b6d318.png)|

### メソッド
```js:index.js
const channel = client.channels.cache.get("チャンネルid"); //チャンネルidからチャンネルを探す
if (!channel) return; //チャンネルが見つからなかった場合、処理を中止

await channel.send("チャンネルが見つかったので、メッセージを送信しました！"); //チャンネルに送信する
```
このメソッドを使用すれば、チャンネルにメッセージを送信することができます。

## メッセージに対して、返信する
メッセージに対して返信するには、メッセージイベントを受け取ったときに、返信する必要があります。
今回はイベントについての説明は省きますので、[こちら](https://qiita.com/minoru_kinugasa/items/37a8d20c6569c73f938a)をごらんください。

### メソッド
```js:index.js
const { Client, GatewayIntentBits } = require('discord.js');
const { token } = require('./config.json');
const client = new Client({
    intents: [
        GatewayIntentBits.Guilds,
        GatewayIntentBits.GuildMessages,
        GatewayIntentBits.MessageContent
    ]
});

client.on('messageCreate', async (message) => { //メッセージが送信されたとき
    if (message.author.bot) return;
    await message.reply("これは返信メッセージです！"); //返信メッセージを送信する
});
```
少し複雑ですが、メッセージが送信されたときに、そのメッセージに対して返信するようになっています。

## ユーザーを探して、ダイレクトメッセージを送信する
### メソッド
```js:index.js
    const guild = client.guilds.cache.get("サーバーのid"); //ユーザーが居るサーバーの取得
    if (!guild) return; //サーバーが見つからなかったら処理を中止

    const member = await guild.members.fetch("ユーザーのid"); //サーバーからユーザーの取得
    if (!member) return; //ユーザーが見つからなかったら処理を中止

    await member.send("ダイレクトメッセージを送信しました。");
```
これで、特定のユーザーにダイレクトメッセージを送信することができます。

# 終わりに
今回は、メッセージの送信方法についての説明をしました！
メッセージには、添付ファイルを送ったり、埋めこみというものを送信することができます。
また長くなってしまうので、それは別の記事に記載します！

- [埋め込みについて](https://qiita.com/minoru_kinugasa/items/297cef8531e81a50343f)
- [添付ファイルについて](https://qiita.com/minoru_kinugasa/items/a6ffc040e52fca8e04aa)
- [メンションについて](https://qiita.com/minoru_kinugasa/items/2b26f6d2006f9f105601)
