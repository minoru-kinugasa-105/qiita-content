---
title: Google Apps Script (GAS) の使い方 【Webアプリ編】
tags:
  - JavaScript
  - GoogleAppsScript
  - GAS
private: false
updated_at: '2024-05-21T10:36:27+09:00'
id: a6930f66bb1d048305ce
organization_url_name: null
slide: false
ignorePublish: false
---
# Google Apps Script (以下gas) とは
詳しくは[こちら](https://qiita.com/tacopic-007/items/05fff88270f9eb59e826)の記事に記載していますが、簡単に説明するとGoogleサービスの自動化スクリプトをAPIなどを使用せずに開発できる、めちゃんこ便利な言語です。
一応、gasって何？って方は[基礎](https://qiita.com/minoru_kinugasa/items/e8421f4fe501ef322535)や[基礎メソッド](https://qiita.com/minoru_kinugasa/items/8428ae5af9f9af0b2810)の記事もありますので是非！

# ファイルの作り方
では早速、webアプリを作成していきます。
gasのページを開き、ファイルの「**＋**」の「**HTML**」を押し、新規HTMLファイルを作成します。
![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3794632/412ef951-5098-f119-4ffa-7239dfd9b8db.png)

# ためしにデプロイしてみる
作成されたHTMLを、一度デプロイ (公開) してみましょう！
HTMLファイルのコードをこのように変更してください。
(すでに自動的に書かれているコードは消して、貼り付けちゃってください！)
```html:無題.html
<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
  </head>
  <body>
    <h1>test deploy</h1>
  </body>
</html>
```

操作パネルの「**保存**」をクリックして、今のコードを保存します。![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3794632/d4cf0680-d90e-3735-ad96-360cdf730cc5.png)
<hr>

次に、`コード.gs`を開き、このコードを追加します。
```js:コード.gs
function doGet(e) {
  const template = HtmlService.createTemplateFromFile('無題');
  return template.evaluate();
}
```

そうしたら、画面右上にある青い「**デブロイ**」ボタンをクリックし、「**新しいデブロイ**」を選択します。
すると、`デブロイタイプを選択してください`と表示されるので、「**歯車マーク**」から「**ウェブアプリ**」を選択します。

![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3794632/77dc5765-a9dd-cd65-5237-e8fcf85545c1.png)

そうしたら自分の好きなようにページの設定をします。

- `説明`欄にはそのアプリの説明でも入れておきましょう。
- `ウェブアプリ`欄は自分のアカウントのメールアドレスを選択しておきます。
- `アクセスできるユーザー`は自分のみが見れるようにするなら**自分のみ**、リンクを知っているユーザー全てが見れるようにするなら**全員**を選択します。

設定が終わったら、「**デプロイ**」をクリックします。
少しまって、デプロイが完了したらそのwebアプリのリンクを取得できます。
リンクにアクセスして、`test deploy`と表示されていたら大成功です！

# 更新の方法
webアプリを試しにデプロイしてみましたが、更新するにはどうしたらいいでしょうか？
先ほどのデプロイと同様に、　「**デプロイ**」をクリックし、今度は「**デプロイを管理**」を選択します。
するとこの画面が出てくるので、「**編集**」をクリックします。
![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3794632/aa582556-6adf-75f2-7c36-4cae217b9ebf.png)

バージョンの中の、「**新しいバージョン**」を選択し、「**デプロイ**」をクリックすると、先ほどと同じようにデプロイすることができます！

# Webアプリにgasコードを埋め込む
htmlに、gasのコードを埋め込んで、処理をおこなうことができます。
```xml:無題.html
<!DOCTYPE html>
<html>
<head>
  <base target="_top">
</head>
<body>
  <h1>Google Apps Script HTML サービスの例</h1>
  
  <p>サーバーサイドの値：<strong><?= message ?></strong></p>

  <button onclick="google.script.run.withSuccessHandler(displayResult).getServerMessage()">実行</button>
  <div id="output"></div>
  
  <script>
    function displayResult(result) {
      document.getElementById('output').innerText = result;
    }
  </script>
</body>
</html>
```
```js:コード.gs
function doGet() {
  var template = HtmlService.createTemplateFromFile('無題');
  template.message = "Hello from server!";
  return template.evaluate();
}

function getServerMessage() {
  return "This message is from the server!";
}

```
- `<? ?>`の中にコードを書くと、`for`のように、htmlに反映しない処理のコードを記述することができます。
- `<?= ?>`の中にコードを書くと、記述したコードを実行した結果をhtmlに反映します。
- `google.script.run.withSuccessHandler(displayResult).関数()`をscript内で記述すると、gasのコードをhtml内で呼び出すことができます。

また、これはjavascriptの話になりますが
関数を実行した際に、返り値として値をしていするときは`return`を使用します。

# 終わりに
今回、GASを学習しながらQiitaの書き方を学びました(-_-;)
なので、みにくいところがあるかもしれませんがご了承ください💦

今後もいろんな記事を投稿するので、よろしくです！
